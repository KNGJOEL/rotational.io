<!DOCTYPE html>
<html lang="fr-fr">
<head>
	<meta charset="utf-8">
	<title>Basic Python Profiling</title>

	<!-- mobile responsive meta -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="description" content="Basic Python Profiling">
	
	<meta name="author" content="Themefisher">
	<meta name="generator" content="Hugo 0.79.1" />

	<!-- plugins -->
	
	<link rel="stylesheet" href="https://rotational.io/plugins/bootstrap/bootstrap.min.css">
	
	<link rel="stylesheet" href="https://rotational.io/plugins/themify-icons/themify-icons.css">
	
	<link rel="stylesheet" href="https://rotational.io/plugins/magnific-popup/magnific-popup.css">
	
	<link rel="stylesheet" href="https://rotational.io/plugins/slick/slick.css">
	
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Anaheim%7cQuattrocento&#43;Sans:400,700&amp;display=swap">
	

	<!-- Main Stylesheet -->
	
	<link rel="stylesheet" href="https://rotational.io/css/style.min.css" media="screen">

	<!-- Custom stylesheet - for your changes -->
	
  <link rel="stylesheet" href="https://rotational.io/css/custom.min.css" media="screen">

	<!--Favicon-->
	<link rel="shortcut icon" href="https://rotational.io/images/favicon.png" type="image/x-icon">
	<link rel="icon" href="https://rotational.io/images/favicon.png" type="image/x-icon">

	

</head>


<body id="body" data-spy="scroll" data-target=".navbar" data-offset="55">
  <div id="content">
    


<section class="sticky-top navigation">
	<div class="container">
		<nav class="navbar navbar-expand-lg navbar-dark">
			<a class="navbar-brand p-0" href="/fr">
				
				<img class="lozad" data-src="https://rotational.io/images/logo.png" alt="Rotational" height="42">
				
			</a>

			<button class="navbar-toggler rounded-0" type="button" data-toggle="collapse" data-target="#navigation">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="navigation">
				<ul class="navbar-nav ml-auto">
					
					<li class="nav-item">
            <a class="nav-link" href="https://rotational.io/#about">sur</a>
					</li>
					
					<li class="nav-item">
            <a class="nav-link" href="https://rotational.io/#services">un service</a>
					</li>
					
					<li class="nav-item">
            <a class="nav-link" href="https://rotational.io/#team">équipe</a>
					</li>
					
					<li class="nav-item">
            <a class="nav-link" href="https://rotational.io/#blog">blog</a>
					</li>
					
					<li class="nav-item">
            <a class="nav-link" href="https://rotational.io/#contact">contact</a>
					</li>
					
				</ul>
				
				<select id="select-language" onchange="location = this.value;">
					
					
					
					
					
					
					
					
					<option id="en" value="https://rotational.io/blog/2020-07-14-basic-python-profiling/">En</option>
					
					
					
					
					
					
					
					
					
					
					
					
					
					<option id="fr" value="https://rotational.io/fr/blog/2020-07-14-basic-python-profiling/" selected>Fr
					</option>
					
					
					
					
				</select>
				
			</div>
		</nav>
	</div>
</section>


<section class="section">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 offset-lg-2 text-center">
        <h1>Basic Python Profiling</h1>
        <ul class="list-inline mb-50">
          <li class="list-inline-item"><a href="/fr/author/benjamin-bengfort/">Benjamin Bengfort</a></li>
          <li class="list-inline-item">Tuesday, Jul 14, 2020</li>
        </ul>
        <img class="img-fluid mb-50 lozad" data-src="https://rotational.io/images/blog/sunrise_c.jpg" alt="blog-image">
      </div>
      <div class="col-lg-8 offset-lg-2">
        <div class="post-single-content">
          <p>I&rsquo;m getting started on some projects that will make use of extensive Python performance profiling, unfortunately Python doesn&rsquo;t focus on performance and so doesn&rsquo;t have benchmark tools like I might find in Go. I&rsquo;ve noticed that the two most important usages I&rsquo;m looking at when profiling are speed and memory usage. For the latter, I simply use <a href="https://pypi.org/project/memory-profiler/"><code>memory_profiler</code></a> from the command line - which is pretty straight forward. However for speed usage, I did find a snippet that I thought would be useful to include and update depending on how my usage changes.</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">cProfile</span>

<span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">pstats</span> <span style="color:#6ab825;font-weight:bold">import</span> Stats
<span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">functools</span> <span style="color:#6ab825;font-weight:bold">import</span> wraps


<span style="color:#6ab825;font-weight:bold">def</span> <span style="color:#447fcf">sprofile</span>(func):
    <span style="color:#ffa500">@wraps</span>(func)
    <span style="color:#6ab825;font-weight:bold">def</span> <span style="color:#447fcf">wrapper</span>(*args, **kwargs):
        pr = cProfile.Profile()
        pr.enable()

        result = func(*args, **kwargs)

        pr.disable()
        Stats(pr).strip_dirs().sort_stats(<span style="color:#ed9d13">&#39;cumulative&#39;</span>).print_stats(<span style="color:#3677a9">20</span>)
        <span style="color:#6ab825;font-weight:bold">return</span> result

    <span style="color:#6ab825;font-weight:bold">return</span> wrapper
</code></pre></div><p>This decorator allows you to profile the speed performance of functions on the stack below the function being decorated. It uses standard library dependencies, which is great, and you can <a href="https://docs.python.org/3.7/library/profile.html#module-pstats">change the way the stats are printed out</a> to suit your needs (e.g. this is formatted well for my analysis style).</p>
<p>The report it prints out is as follows:</p>
<pre><code>        7636523 function calls (7636479 primitive calls) in 14.669 seconds

   Ordered by: cumulative time
   List reduced from 306 to 20 due to restriction &lt;20&gt;

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000   14.669   14.669 sequential.py:107(run)
      150    2.584    0.017   14.633    0.098 sequential.py:75(step)
   843750   10.228    0.000   10.335    0.000 grid.py:72(neighborhood_sum)
   843750    0.765    0.000    0.988    0.000 grid.py:129(__setitem__)
   843750    0.529    0.000    0.726    0.000 grid.py:124(__getitem__)
  2531454    0.275    0.000    0.275    0.000 {built-in method builtins.isinstance}
  1687783    0.145    0.000    0.145    0.000 {built-in method builtins.len}
   843750    0.107    0.000    0.107    0.000 grid.py:57(adjacency)
      151    0.001    0.000    0.020    0.000 std.py:1099(__iter__)
       82    0.000    0.000    0.019    0.000 std.py:1317(refresh)
       83    0.000    0.000    0.017    0.000 std.py:1447(display)
       83    0.000    0.000    0.015    0.000 std.py:1089(__repr__)
      9/4    0.000    0.000    0.014    0.004 &lt;frozen importlib._bootstrap&gt;:978(_find_and_load)
      9/4    0.000    0.000    0.014    0.004 &lt;frozen importlib._bootstrap&gt;:948(_find_and_load_unlocked)
       83    0.002    0.000    0.014    0.000 std.py:310(format_meter)
      9/4    0.000    0.000    0.013    0.003 &lt;frozen importlib._bootstrap&gt;:663(_load_unlocked)
     17/6    0.000    0.000    0.011    0.002 &lt;frozen importlib._bootstrap&gt;:211(_call_with_frames_removed)
        1    0.000    0.000    0.010    0.010 std.py:511(__new__)
        1    0.000    0.000    0.009    0.009 std.py:623(get_lock)
        1    0.000    0.000    0.009    0.009 std.py:79(__init__)
</code></pre><p>You can see in this report that the majority of time is being spent in the <code>neighborhood_sum</code> function from line 3 and that the <code>step</code> function calls it nearly 5,625 times!</p>

        </div>
        
        <div class="mt-5">
          
        </div>
      </div>
    </div>
  </div>
</section>


  </div><!-- end Contact Area -->
<footer id="footer" class="section-bg">
	<div class="container">
		<div class="row wow fadeInUp" data-wow-duration="500ms">
			<div class="col-xl-12">

				<!-- Footer Social Links -->
				<div class="social-icon">
					<ul class="list-inline">
						
					</ul>
				</div>

				<!-- copyright -->
				<div class="copyright text-center">
					<a href="https://rotational.io/fr/">
						<img src="https://rotational.io/images/logo.png" alt="Rotational" height="42" />
					</a>
					<br>
					<p>Copyright © 2021 Rotational Labs, LLC · Powered by <a href="https://gethugothemes.com">Hugo</a> · Theme by <a href="https://themefisher.com">Themefisher</a></p>
				</div>
			</div>
		</div>
	</div>
</footer>
<!-- /footer -->

<!-- Google Map API -->


<!-- JS Plugins -->

<script src="https://rotational.io/plugins/jquery/jquery.min.js"></script>

<script src="https://rotational.io/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://rotational.io/plugins/slick/slick.min.js"></script>

<script src="https://rotational.io/plugins/shuffle/shuffle.min.js"></script>

<script src="https://rotational.io/plugins/magnific-popup/jquery.magnific-popup.min.js"></script>

<script src="https://rotational.io/plugins/lazy-load/lozad.min.js"></script>

<script src="https://rotational.io/plugins/google-map/map.js"></script>


<!-- Main Script -->

<script src="https://rotational.io/js/script.min.a04247499d1b47349e9b15e536b4303bff63b1b6b8b5b74605302e956ed68179703fe8d52b0c3b0d9022d056576c679f.js" integrity="sha384-oEJHSZ0bRzSemxXlNrQwO/9jsba4tbdGBTAulW7WgXlwP&#43;jVKww7DZAi0FZXbGef"></script>


</body>

</html>
